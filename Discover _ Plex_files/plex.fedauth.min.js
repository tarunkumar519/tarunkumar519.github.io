"use strict";function ajax(e){var t=e.method,n=void 0===t?"GET":t,i=e.url,r=e.data,o=e.raw,a=e.headers,s=void 0===a?{}:a;return new Promise(function(e,t){var a=new window.XMLHttpRequest;a.withCredentials=!0;var l=!1;a.ontimeout=function(){l=!0},a.open(n,i);for(var d in s)a.setRequestHeader(d,s[d]);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.onreadystatechange=function(){if(l&&t(),4===a.readyState){var n=a.status,i=n>=200&&n<300||304===n,r=a.responseText;if(o)i?e(r):t({status:n,response:r});else{var s=void 0;try{s=JSON.parse(a.responseText)}catch(e){i=!1}i?e(s):t({status:n,json:s})}}},a.send(stringifyParams(_extends({"X-Plex-Client-Identifier":plexClientIdentifier},r)))})}function getByPostMessage(e){var t=$.Deferred();return getPostMessage({url:replaceUrlProtocol(window.location.origin,"https:")+"/service-reflector",data:e,timeout:5e3,onMessage:function(e){!0===e.success?t.resolve(e.data,getStatusText(e.xhr),e.xhr):!1===e.success&&t.reject(e.xhr,getStatusText(e.xhr))}}),t.promise()}function getPostMessage(e){function t(){window.document.body.removeChild(l),window.removeEventListener("message",n),clearTimeout(s)}function n(e){if(e.source===l.contentWindow){var n=void 0;try{n=JSON.parse(e.data)}catch(e){}n&&(o(n),t())}}var i=e.url,r=e.data,o=e.onMessage,a=e.timeout,s=setTimeout(function(){o({success:!1}),t()},a);window.addEventListener("message",n);var l=window.document.createElement("iframe");l.style.display="none",l.src=i+"#"+encodeURIComponent(JSON.stringify({data:r})),window.document.body.appendChild(l)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};!function(e,t){var n={run:function(n){var i=n.method,r=void 0===i?"GET":i,o=n.url,a=n.data,s=n.raw,l=n.headers,d=void 0===l?{}:l;return new Promise(function(n,i){var l=new t.XMLHttpRequest;l.withCredentials=!0;var u=!1;l.ontimeout=function(){u=!0},l.open(r,o);for(var c in d)l.setRequestHeader(c,d[c]);l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),l.onreadystatechange=function(){if(u&&i(),4===l.readyState){var e=l.status,t=e>=200&&e<300||304===e,r=l.responseText;if(s)t?n(r):i({status:e,response:r});else{var o=void 0;try{o=JSON.parse(l.responseText)}catch(e){t=!1}t?n(o):i({status:e,json:o})}}};var g=_extends({"X-Plex-Client-Identifier":Plex.getClientIdentifier()},a);l.send(e.param(g))})},getUserAPIPromise:function(t){var n={"X-Plex-Product":"Plex SSO","X-Plex-Client-Identifier":Plex.getClientIdentifier()};return t.headers=_extends({},n,t.headers||{}),e.ajax(t)},minDuration:function(t,n){function i(){var e=(new Date).getTime(),t=Math.max(o-e,0);setTimeout(a,t)}var r=e.Deferred(),o=(new Date).getTime()+n,a=void 0;return t.then(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a=function(){return r.resolve.apply(r,t)}},function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a=function(){return r.reject.apply(r,t)}}),t.then(i,i),r.promise()},maxDuration:function(t,n){var i=e.Deferred(),r=setTimeout(function(){i.reject()},n);return t.then(i.resolve,i.reject).always(function(){clearTimeout(r)}),i.promise()},alwaysResolve:function(t){var n=e.Deferred();return t&&t.then?t.then(n.resolve,n.resolve):n.resolve(t),n.promise()}};t.PlexAjax=n}(jQuery,window),function(e,t){var n={auth:function(){var t=e.Deferred(),n={};if("apple"!==PlexSignIn.getURLHashParams("provider"))return t.resolve();var i=PlexSignIn.getURLHashParams();return void 0===i||"1"!=i.externalFederatedAuthComplete||i.error?t.reject(PlexSignIn.getURLHashParams("error")):void 0===i.id_token?t.reject():PlexAuthFederated.auth({provider:"apple",providerToken:i.id_token},n)}};t.PlexAuthApple=n}(jQuery,window),function(e,t){var n={auth:function(n){var i=e.Deferred(),r={skipAuth:!0};return void 0===n?i.reject():Plex.isSignedIn()?void 0:(PlexSignIn.setIsSigninIn(!0),PlexAuthFederated.auth({provider:"google",providerToken:n.credential},r).then(function(){t.location.reload()}).fail(function(e){console.error(e),PlexSignIn.setIsSigninIn(!1)}))}};t.PlexAuthGoogle=n}(jQuery,window),function(e,t){var n={auth:function(t,n){var i=e.Deferred(),r=PlexUtils.getAPIUrl()+"/api/v2/users/authenticate";r=PlexUtils.getURLWithUTMParams(PlexUtils.getURLWithUTMParams(r)),r=PlexUtils.setURLParameter(r,"utm_content","googleOneTap");var o=new URL(r);return o.searchParams.append("provider",t.provider),o.searchParams.append("providerToken",t.providerToken),n.authToken&&!n.skipAuth?t["X-Plex-Token"]=n.authToken:n.skipAuth&&(t.skipAuth=!0),PlexAjax.getUserAPIPromise({url:o,type:"POST",data:t,dataType:"json",xhrFields:{withCredentials:!0}}).done(function(e){i.resolve({authToken:e.authToken,uuid:e.uuid,metricsEvent:e.created?PlexSignUp.SIGN_UP:PlexSignIn.SIGN_IN,metricsMode:t.provider,isFirstRun:n.isFirstRun,response:e})}).then(null,function(e){var t=e&&e.status?e.responseJSON.errors:null;i.reject(t)}),i.promise()}};t.PlexAuthFederated=n}(jQuery,window),function(e,t){var n={providers:[],signIn:null},i={set:function(t){this.sessionAttrs=e.extend(!0,this.sessionAttrs,t)},get:function(){return this.sessionAttrs},reset:function(){this.sessionAttrs=e.extend(!0,this.sessionAttrs,this.defaults)}},r={signin:{title:"Sign In",class:".signin-dynamic"},signup:{title:"Sign Up",class:".signup-dynamic"},reset:{title:"Reset Password",class:".reset-dynamic"}},o=e.extend({name:"SignInPageModel",defaults:{errorMessage:"",myPlexAccessToken:"",providerID:"",providerToken:"",isBusy:!1,isAdditionalAuthNeeded:!1,isAdditionalAuthPassword:!1,isSuccess:!1,additionalAuthEmail:"",additionalAuthProviderIDs:[],ssoEmail:"",ssoMyPlexAccessToken:"",isResetPasswordSubmitted:!1,isResetPasswordError:!1},sessionAttrs:{action:"signin",isModal:!1,isSignUp:!1,redirectWeb:!0,forwardUrl:"",errorMessage:"",myPlexAccessToken:"",providerID:"",providerToken:"",isBusy:!1,isAdditionalAuthNeeded:!1,isAdditionalAuthPassword:!1,isSuccess:!1,additionalAuthEmail:"",additionalAuthProviderIDs:[],ssoEmail:"",ssoMyPlexAccessToken:"",isResetPasswordSubmitted:!1,isResetPasswordError:!1}},i),a=e.extend({name:"FederatedAuthProviderModel",context:["signInPageModel"],rootPropertyName:"provider",sessionAttrs:{isLoading:!0,isError:!1,label:"",providerID:"",providerToken:"",email:""}},i),s={getFormModel:function(e){return r[e]},getFedAuthProviderModel:function(t,i){var r=e.extend(!0,{},a);return void 0!==i?r:(n.providers[t]=e.extend(!0,r,n.providers[t]),n.providers[t])},getSignInModel:function(){var t=e.extend(!0,{},o);return n.signIn=e.extend(!0,t,n.signIn),n.signIn}};t.PlexModel=s}(jQuery,window),function(e,t){var n={SIGN_IN:"signin",maxAttempts:0,totalAttempts:0,isSignedInPage:function(){return location.href.indexOf("sign-in/")>=0},isSignedUpPage:function(){return location.href.indexOf("sign-up/")>=0},getSignInPageURL:function(){return plex_l10n.pages.signin},getSignIUpPageURL:function(){return plex_l10n.pages.signup},isAdditionalAuthNeeded:function(){return PlexModel.getSignInModel().get().isAdditionalAuthNeeded},getBaseForwardURL:function(){return t.location.href.split("#?")[0]},setIsSigninIn:function(e){var t=Plex.isSigninIn();Plex.setIsSigninIn(e),t!==e&&(PlexView.refresh(),PlexTemplating.userStateChanged())},clearURLHashParams:function(e){e=e||t.location.origin+t.location.pathname+t.location.search;var n=e;try{history.replaceState("",document.title,n)}catch(e){}},getURLHashParams:function(e){if(!(t.location.href.indexOf("#?")<0)){var n=t.location.href.split("#?"),i=n[1],r=PlexUtils.getParamsFromStringURL(i);return void 0===e?r:r[e]||!1}},alreadySignedIn:function(){var i=e("[data-remodal-id="+t.modalFedAuth+"]"),r=i.remodal();(void 0===r||"opened"===r.getState()||n.isSignedInPage()||n.isSignedInPage())&&(void 0!==i&&i.length>0&&i.find(".remodal-close").hide(),void 0!==r&&setTimeout(function(){r.close()},500))},signInSSO:function(){"apple"===n.getURLHashParams("provider")?(n.setIsSigninIn(!0),PlexAuthApple.auth().then(function(){n.maxAttempts=3,n.loadSSO()}).fail(function(t){if(n.setIsSigninIn(!1),t&&void 0!==t[0]&&void 0!==t[0].code&&1044===t[0].code){PlexModel.getSignInModel().set({isAdditionalAuthNeeded:!0}),e(document).trigger("fedaAuthAdditionalAuth")}})):n.loadSSO()},loadSSO:function(){var t=Plex.getAuthInfo("authToken"),i=t&&t.authToken||!1,r={"X-Plex-Product":"Plex SSO","X-Plex-Client-Identifier":Plex.getClientIdentifier()};return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users/signin",method:"POST",data:{noGuest:!0,skipAuthentication:!0},headers:r,dataType:"json",xhrFields:{withCredentials:!0}}).then(function(t){var n=PlexModel.getSignInModel(),r="signin";if(t&&void 0!==t.authToken&&t.authToken&&i!==t.authToken){var o="0"!==t.rememberExpiresAt;t=e.extend({roles:[]},t),PlexUtils.getParam("signUp")&&"1"==PlexUtils.getParam("signUp")&&(r="signup"),Plex.setAuthInfo(t,o),e(document).trigger("fedAuthStateChange",r)}return t&&void 0!==t.authToken&&t.authToken&&n.set({action:r,ssoMyPlexAccessToken:t.authToken,ssoEmail:t.email}),n.get()}).fail(function(e){return Plex.isSigninIn()&&(!n.maxAttempts||n.maxAttempts&&n.totalAttempts>=n.maxAttempts)?n.setIsSigninIn(!1):Plex.isSignedIn()&&Plex.removeAuthInfo(),e}).always(function(){var t=PlexModel.getSignInModel();!Plex.isSignedIn()&&n.totalAttempts<n.maxAttempts?(n.totalAttempts++,setTimeout(function(){n.loadSSO()},500)):e(document).trigger("fedAuthFinished",[{action:t.action}])})}};t.PlexSignIn=n}(jQuery,window),function(e,t){var n={SIGN_OUT:"signout",signOut:function(t){return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users/signout",type:"DELETE",dataType:"json",xhrFields:{withCredentials:!0},headers:{"X-Plex-Token":t}}).then(function(e){},function(t){return e.Deferred().reject(t&&t.status?t.responseJSON.errors:[]).promise()})}};t.PlexSignOut=n}(jQuery,window),function(e,t){var n={SIGN_UP:"signup",signUp:function(i,r){return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users",type:"POST",data:i,dataType:"json",xhrFields:{withCredentials:!0}}).then(function(e){return t.PlexNewUser=!0,{authToken:e.authToken,uuid:e.uuid,metricsEvent:n.SIGN_UP,metricsMode:"password",isFirstRun:r.isFirstRun,response:e}},function(t){return e.Deferred().reject(t&&t.status?t.responseJSON.errors:[]).promise()})}};t.PlexSignUp=n,t.PlexNewUser=!1}(jQuery,window);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};!function(e,t){function n(n){return function(i,r,a){var s=PlexModel.getSignInModel(),l=r.formData,d=r.options,u=l.providerToken,c=l.password,g=d.providerID,f=(d.forwardUrl,{isBusy:!0,errorMessage:null,providerID:g,providerToken:u});s.set(f),n(l,d,i).then(function(n){var i=n.metricsEvent,r=n.metricsMode,l=n.isFirstRun,d=n.authToken,u=n.uuid,c=n.response;PlexMetrics.track(i,i,{properties:{mode:r,firstRun:l}}),PlexHelpers.trackMetricsEvents();var f=Cookies.get("plex_tv_cj");f&&(f=JSON.parse(f));var p=null;void 0!==f&&void 0!==f.CJEVENT&&(p=f.CJEVENT),t.PLEX_USER_UUID=u,t.PLEX_CJ_EVENT=p,t.PLEX_HAS_CJ_COOKIE=!!f;var P=o[i];P&&PlexMetrics.pushEvent(P),s.set({isSuccess:!0,myPlexAccessToken:d,providerID:g}),void 0!==c.created&&s.set({action:c.created?"signup":"signin"});var m="0"!==c.rememberExpiresAt;c=e.extend({roles:[]},c),Plex.setIsSigninIn(),Plex.setAuthInfo(c,m),void 0!==a&&a(s)}).fail(function(e){var t={isBusy:!1};if(!e||PlexHelpers.isUnrecoverable(e,g))t.errorMessage=PlexHelpers.getSignInErrorMessage(e);else if(PlexHelpers.isRecoverableByClearingProviderAuth(e,g)){var n=PlexModel.getFedAuthProviderModel(g);n.set({providerToken:null}),t.errorMessage=PlexHelpers.getSignInErrorMessage(e)}else!c&&PlexHelpers.isAdditionalAuthNeeded(e)?(t.isAdditionalAuthNeeded=!0,t.isAdditionalAuthPassword=PlexHelpers.isAdditionalAuthPassword(e),t.additionalAuthEmail=PlexHelpers.additionalAuthEmail(e),t.additionalAuthProviderIDs=PlexHelpers.additionalAuthProviderIDs(e)):PlexHelpers.isIgnorable(e)||(t.errorMessage=PlexHelpers.getSignInErrorMessage(e));s.set(t),void 0!==a&&a(s,e)})}}function i(e){var t=Plex.getSignInPage("/?"),n={forwardUrl:e},i=function e(t,n){var i,r=[];for(i in t)if(t.hasOwnProperty(i)){var o=n?n+"["+i+"]":i,a=t[i];r.push(null!==a&&"object"===(void 0===a?"undefined":_typeof(a))?e(a,o):encodeURIComponent(o)+"="+encodeURIComponent(a))}return r.join("&")};PlexSignOut.signOut(Plex.getAuthToken()).always(function(){Plex.removeAuthInfo();var r=new Event("plex_signout");document.dispatchEvent(r),void 0!==e&&(t+=i(n),PlexUtils.redirect(t))})}var r,o=(r={},_defineProperty(r,PlexSignUp.SIGN_UP,"SignUpSuccess"),_defineProperty(r,PlexSignIn.SIGN_IN,"SignInSuccess"),r),a=function(e){return e}({loadProvider:function(e,t){var n=e.options,i=n.providerID,r=PlexModel.getFedAuthProviderModel(i);r.set(_extends({isLoading:!0,isError:!1},PlexAuthFederated.federatedAuthProviders[i])),(0,PlexAuthFederated.LOAD_FEDERATED_AUTH_PROVIDER_HELPERS[i])().then(function(e){r.set(_extends({isLoading:!1,isError:!1},e)),t(i)},function(e){r.set({isLoading:!1,isError:!0}),t(i,e)})},authProvider:function(e,t,i){var r=t.options,o=r.providerID,a=PlexModel.getFedAuthProviderModel(o);return a.set({isLoading:!0}),n(function(){var e=PlexAuthFederated.USE_FEDERATED_AUTH_PROVIDER_HELPERS[o],t=e.apply(void 0,arguments);return t.fail(function(e){a.set({isLoading:!1})}),t})(e,t,i)},signin:n(PlexSignIn.signIn),signup:n(PlexSignUp.signUp),signout:function(e){i(e)},reset:function(e,t,n){var i=PlexModel.getSignInModel();i.set({isBusy:!0,isResetPasswordError:!1}),PlexAjax.minDuration(PlexReset.resetPassword(t.formData),1e3).done(function(){i.set({isResetPasswordSubmitted:!0}),PlexHelpers.trackMetricsEvents()}).fail(function(){i.set({isResetPasswordError:!0})}).always(function(e,t){i.set({isBusy:!1}),n(i,e)})},trackClicks:function(t,n,i){var r={context:e(location).attr("origin")+e(location).attr("pathname")+(i?n+"[modal]":"")};if("signup"!==t&&("signin"!==t||"signup"===n)){var o={reset:"forgotPassword","terms-of-service":"termsOfService","privacy-policy":"privacyPolicy",signin:"signIn"};t=void 0!==o[t]?o[t]:t,PlexMetrics.track("click",t,{properties:r})}}});t.PlexSignInActions=a}(jQuery,window);var _slicedToArray=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(e,t){function n(t,n){var i={fedAuthModal:".modal-fedauth",fedAuthRemodal:".remodal-fedauth",panelLeft:".fedauth-panel-left",panelRight:".fedauth-panel-right",fedAuthTitle:".fedauth-title",fedAuthTitleDesc:".fedauth-title-desc",toggleForm:".toggle-form",fedAuthiFrame:"#fedauth-iFrame",fedAuthWait:".fedauth-wait"};return void 0!==n?i[t]:e(i[t])}function i(t){var i=n("fedAuthModal"),r=n("fedAuthRemodal");o(null,t),i.show(),r.find(".remodal-close").fadeIn("slow"),u.isModal&&u.hasSlider&&e(document).on("closed",".remodal-fedauth",function(){e(".signup-hero-inside").slick("unslick")})}function r(e,t){return t=t||!1,t&&(e=e.replace("sign-in/",""),e=e.replace("sign-up/","")),PlexUtils.isLocalDevelopment()&&(e=e.replace("https://www.plex.test",PlexUtils.getDefaultStagingUrl()),e=e.replace(".plex.tv","-www.plex.tv")),e}function o(t,n){var i=PlexModel.getSignInModel();void 0!==t&&t?(t.preventDefault(),n=e(t.currentTarget).hasClass("reset-password")?"reset":e(t.currentTarget).hasClass("signin")?"signin":"signup",PlexSignInActions.trackClicks(n,u.context,u.isModal)):"#resetPassword"===PlexUtils.getURLHash()&&(n="reset");var r=PlexModel.getFormModel(n),o=r.class;i.reset(),PlexModel.getSignInModel().set({action:n,isModal:u.isModal,redirectWeb:!(!u.data.redirectWeb||"0"===u.data.redirectWeb)}),a(o)}function a(e,t){var i=PlexModel.getSignInModel().get(),r=n("panelRight");t=void 0!==t?t:i.action,r.find(".toggable:not("+e+")").addClass("fedoff"),r.find(".toggable"+e).removeClass("fedoff"),r.removeClass(function(e,t){return(t.match(/(^|\s)active-action-\S+/g)||[]).join(" ")}),r.addClass("active-action-"+t),s(!0)}function s(e){l(e,e)}function l(e,t){var i=n("fedAuthTitle"),r=n("fedAuthTitleDesc");i.toggle(e),r.toggle(t)}function d(e,t,n,i){t=void 0!==t&&t,u.start(e,t,n,i)}var u={isCheckout:!1,isModal:!1,context:"signin",iframe:null,formLoaded:[],activeForm:"",isSignPage:!1,data:{redirectWeb:!0},maxSignInAttempts:3,attemptsSignin:0,hasSlider:!1,start:function(t,n,r,o){var a=PlexModel.getSignInModel();u.isCheckout=o||!1,u.isModal=n,u.data=e.extend(u.data,r),u.context=t,u.isSignPage=PlexSignIn.isSignedInPage()||PlexSignIn.isSignedUpPage(),a.set({action:t,isModal:u.isModal,forwardUrl:PlexUtils.getParam("forwardUrl"),redirectWeb:!(!u.data.redirectWeb||"0"===u.data.redirectWeb)}),u.authAppiFrame(),e(document).ready(function(){i(t)})},authAppiFrame:function(i){function o(){u.slickSignup();var e="";t.iFrameResize({log:!1,checkOrigin:!PlexUtils.isDevelopment(),onInit:function(e){e.iframe;Plex.debugLog()&&console.log("Init iFrame")},onMessage:function(n){var i=(n.iframe,n.message);if(A(),Plex.debugLog()&&(console.log("[marketing-site] received message"),console.log(i)),"SET_VALUE_ON_WINDOW"===i.type&&"PLEX_USER_UUID"===i.name&&(e=i.value,t.PLEX_USER_UUID=e),"PUSH_GOOGLE_TAG_MANAGER_DATA"===i.type){Cookies.remove("plex_tv_debug_gtm_event");var r=PlexUtils.getParam("origin")||!1,o={eventOrigin:r||"marketing",anon:!1,uuid:e},s="";i.data?(s=i.data.event,o.anon=i.data.anon):i.event&&(s=i.event),PlexMetrics.pushEvent(s,function(){Plex.debugLog()&&(console.log("Google GTM result"),Plex.debugLog()&&Cookies.set("plex_tv_debug_gtm_event",s))},o)}else if("SIGN_UP_CHANGE"===i.type){var l=i.signUp?"signup":"signin",d=PlexModel.getFormModel(l),u=d.class;a(u)}}},s),u.formLoaded.push(u.isModal?"fedauth-form-modal":"fedauth-form")}if(i=i||"ready",Plex.isSignedIn()||Plex.isSigninIn())return void(Plex.isSignedIn()&&(u.isSignPage?PlexSignIn.loadSSO().then(function(){PlexSignIn.alreadySignedIn(),PlexUtils.redirectSignedInUser()}).fail(function(){u.maxSignInAttempts&&u.attemptsSignin<u.maxSignInAttempts?(u.attemptsSignin++,u.authAppiFrame()):PlexUtils.redirectSignedInUser()}):PlexSignIn.alreadySignedIn()));var s=n("fedAuthiFrame","class"),l=PlexModel.getSignInModel(),d=l.get(),c="signup"===d.action?1:0;u.iframe&&(u.iframe=null),u.iframe=t.document.createElement("iframe");var g=d.forwardUrl,f=t.location.href;!PlexUtils.getParam("fwdUrl")&&u.isSignPage?(f=PlexUtils.setURLParameter(f,"forwardUrl",""),f=PlexUtils.setURLParameter(f,"fwdUrl",g)):PlexUtils.getParam("fwdUrl")&&l.set({forwardUrl:decodeURIComponent(PlexUtils.getParam("fwdUrl"))}),d.redirectWeb||(f=PlexUtils.setURLParameter(f,"skipWeb",1)),f=PlexUtils.setURLParameter(f,"signUp",c),f=r(f);var p=PlexUtils.getParam("guestToken")||!1,P={enableSignInWithApple:1,skipLanding:1,signUp:c,forwardUrl:f,externalFederatedAuthCompleteUrl:f,clientID:Plex.getClientIdentifier(),"context[device][product]":"Plex SSO",redirect_uri:PlexSignIn.getURLHashParams("redirect_uri")||"",provider:PlexSignIn.getURLHashParams("provider")||"",state:PlexSignIn.getURLHashParams("state")||"",id_token:PlexSignIn.getURLHashParams("id_token")||"",code:PlexSignIn.getURLHashParams("code")||"",externalFederatedAuthComplete:PlexSignIn.getURLHashParams("externalFederatedAuthComplete")||""};if(p&&(P.guestToken=p),parseInt(P.externalFederatedAuthComplete)){var m=PlexUtils.setURLParameter(PlexSignIn.getBaseForwardURL(),"signUp",0);P.forwardUrl=m,P.externalFederatedAuthCompleteUrl=m}if(PlexUtils.isDevelopment()&&PlexUtils.isNewEnvDomain()&&(P.forwardUrl=PlexUtils.getDefaultStagingUrl()),"en_US"!==PlexLanguage.getSelectedLanguageCode()&&(P.language=PlexLanguage.getSelectedLanguageCode()),f){var x=f.split("?");if(x.length>1){var h=new URLSearchParams(x[1]),v=h.entries();P=Object.assign({},P,function(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=_slicedToArray(s,2),d=l[0],u=l[1];if(!PlexUtils.getParam("dogfood")&&"forwardUrl"===d&&!u)return;t[d]=u}}catch(e){i=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}return t}(v))}}var S=PlexUtils.buildURLParams(P);PlexUtils.isDevelopment()?u.iframe.src=PlexUtils.getCurrentWebStagingAPIUrl()+"/auth-form/?myPlexUrl="+PlexUtils.getDefaultStagingUrl()+"/#!?"+S:u.iframe.src=PlexUtils.getWebUrlBase()+"/auth-form/#!?"+S,u.iframe.style="width:100%;height:100%;border:none;margin:0;padding:0;left:0;overflow:hidden;z-index:999999;min-height:750px;",u.iframe.setAttribute("id","fedauth-iFrame"),u.iframe.setAttribute("name","fedauth-iFrame"),Plex.debugLog()&&console.log("Auth forwardUrl = "+P.forwardUrl),u.activeForm="fedauth-form",d.isModal&&(u.activeForm="fedauth-form-modal");var A=function(){e(document.getElementById(u.activeForm)).closest(".fedauth-panel").find(n("fedAuthWait","class")).remove()};document.getElementById(u.activeForm)&&(document.getElementById(u.activeForm).innerHTML="",document.getElementById(u.activeForm).appendChild(u.iframe));var U=n("fedAuthiFrame");"ready"===i?U.ready(function(){o()}):U.load(function(){o()})},signMetricsEvents:function(e){"SignInSuccess"===e&&"undefined"!=typeof PlexAppsFlyer&&PlexAppsFlyer.metricsEvent("signin")},slickSignup:function(){var t=function(){e(".signup-hero-inside").slick({autoplay:!0,pauseOnHover:!1,dots:!1,arrows:!1,infinite:!0,fade:!0,speed:600,autoplaySpeed:3e3}),u.hasSlider=!0};try{t()}catch(n){e(document).on("plex_slick_init",function(){t()})}}},c={action:"signin",panels:"all"};e(document).on("fedauthModalOpened",function(i,r){r=e.extend(c,r);var o=e("[data-remodal-id="+t.modalFedAuth+"]");if(void 0!==o.attr("data-last-action")&&(r.action=o.attr("data-last-action"),o.removeAttr("data-last-action")),"right"===r.panels){n("getElement").hide()}PlexMetrics.track("view",r.action,{properties:{page:plex_l10n.curr_page+"[modal]"}}),d(r.action,!0,r)}),e(document).on("fedAuthOpened",function(e,t,n){d(t,!1,{},n)}),e(document).ready(function(){e(document).on("fedAuthStateChange",function(e,t){var n=parseInt(PlexUtils.getParam("signUp")),i=PlexModel.getSignInModel().get();PlexSignIn.clearURLHashParams();var o=i.forwardUrl,a="";if(u.isCheckout||o||(PlexUtils.getParam("forward")?"web"===(o=PlexUtils.getParam("forward"))&&(a=PlexUtils.getWebUrl()):PlexUtils.isMobile()&&n?a="/onboard/mobile/":n&&i.redirectWeb&&!PlexUtils.getParam("skipWeb")&&(a=PlexUtils.getWebUrl()),a&&(o=a)),o=decodeURIComponent(r(o,!0)),"signup"===t&&PlexMetrics.track("signup-mkt",plex_l10n.curr_page),a||u.isSignPage){o=o||null;var s="signup"===t?500:0;setTimeout(function(){PlexUtils.redirect(o)},s)}}),t.addEventListener("plexLocationChange",function(e){return!(!parseInt(PlexSignIn.getURLHashParams("externalFederatedAuthComplete")||0)&&u.isCheckout)||(!PlexUtils.getParam("plan")&&"register"!==PlexUtils.getParam("step")||(PlexModel.getSignInModel().set({forwardUrl:e.detail.nextLocation}),void u.authAppiFrame("onLoad")))}),e(document).on("fedaAuthAdditionalAuth",function(e){u.authAppiFrame()}),e(document).on("click",".signin:not(.action), .go-signin",function(){return e(this).trigger("fedAuth",[{action:"signin",panels:"all"}]),!1}),e(document).on("click",".signup:not(.action), .go-signup",function(){return e(this).trigger("fedAuth",[{action:"signup",panels:"all",redirectWeb:e(this).data("redirectweb")}]),!1}),e(document).on("click",".signout, .go-signout",function(){return PlexView.loading(),PlexSignInActions.signout(),!1}),e(document).on("click",".signout-other",function(){var t=location.href;return PlexView.loading(),void 0!==e(this).data("forward")&&(t=""),PlexSignInActions.signout(t),!1})})}(jQuery,window);